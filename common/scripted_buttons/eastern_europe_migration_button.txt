german_migration_button = {
	name = german_migration_button
	desc = german_migration_button_desc

	visible = { always = yes }

	possible = {
		# Note that this closely reflects triggers in the event. Do not change one without changing both
		custom_tooltip = {
			text = german_migration_button_cooldown_tt
			NOT = { has_variable = german_migration_cooldown }
		}
		culture_percent_country = {
			target = cu:north_german
			value > 0.05
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
		c:DDR ?= {
			any_scope_state = {
				NOT = {
					has_variable = german_migration_state_var
				}
			}
		}
	}

	effect = {
		random_state = {
			limit = {
				owner = c:DDR
				NOT = {
					has_variable = german_migration_state_var
				}
			}
			save_temporary_scope_as = german_migration_target_state
			set_variable = {
				name = german_migration_state_var
			}
		}
		c:POL = {
			save_temporary_scope_as = migration_country
		}
		cu:north_german = {
			save_temporary_scope_as = migration_culture
		}

		set_variable = {
			name = german_migration_cooldown
			months = 2
		}
		scope:german_migration_target_state = {
			create_mass_migration = {
				origin = scope:migration_country
				culture = scope:migration_culture
			}
		}
		custom_tooltip = {
			text = mass_migration_button_germany_tt
		}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_10_button = {
	name = german_expulsion_10_button
	desc = german_expulsion_10_button_desc

	visible = {
		is_ai = yes
	}

	possible = {
		# Note that this closely reflects triggers in the event. Do not change one without changing both
		custom_tooltip = {
			text = migration_button_cooldown_tt
			NOT = { has_variable = german_migration_cooldown }
		}
		culture_percent_country = {
			target = cu:north_german
			value > 0.05
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
		c:DDR ?= {
			any_scope_state = {
				NOT = {
					has_variable = german_migration_state_var
				}
			}
		}
	}

	effect = {
		random_state = {
			limit = {
				owner = c:DDR
				NOT = {
					has_variable = german_migration_state_var
				}
			}
			save_temporary_scope_as = german_migration_target_state
			set_variable = {
				name = german_migration_state_var
			}
		}
		c:POL = {
			save_temporary_scope_as = migration_country
		}
		cu:north_german = {
			save_temporary_scope_as = migration_culture
		}

		set_variable = {
			name = german_migration_cooldown
			months = 2
		}
		scope:german_migration_target_state = {
			create_mass_migration = {
				origin = scope:migration_country
				culture = scope:migration_culture
			}
		}
		custom_tooltip = {
			text = mass_migration_button_tt
		}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_pomerania_button = {
	name = german_expulsion_pomerania_button
	desc = german_expulsion_pomerania_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_WEST_POMERANIA
			culture_percent_state = {
				target = cu:north_german
				value > 0.05
			}
		}
	}

	possible = {
		s:STATE_WEST_POMERANIA.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value >= 0.05
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		random_state = {
			limit = {
				state_region = s:STATE_WEST_POMERANIA
			}
			save_temporary_scope_as = german_expulsion_state
			add_modifier = {
				name = ongoing_exile
				days = 42
			}
		}
		random_state = {
			limit = {
				owner = c:DDR
			}
			save_temporary_scope_as = german_migration_target_state
		}
		c:POL = {
			save_temporary_scope_as = migration_country
		}
		c:DDR = {
			save_temporary_scope_as = exile_country
		}
		cu:north_german = {
			save_temporary_scope_as = migration_culture
		}

		custom_tooltip = {
			text = exile_germans_tt
			scope:german_expulsion_state = {
				every_scope_pop = {
					limit = {
						culture = scope:migration_culture
					}
					change_pop_culture = {
						target = cu:immigrant
						value = 0.75
					}
				}
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					move_pop = scope:german_migration_target_state
				}
			}
			scope:exile_country = {
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					change_pop_culture = { target = scope:migration_culture value = 1 }
				}
			}
		}
		#every_country = {
		#	limit = {
		#		is_ai = no
		#		this = c:POL
		#	}
		#	post_notification = eligible_for_exile
		#}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_gr_poland_button = {
	name = german_expulsion_gr_poland_button
	desc = german_expulsion_gr_poland_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_GREATER_POLAND
			culture_percent_state = {
				target = cu:north_german
				value > 0.05
			}
		}
	}

	possible = {
		s:STATE_GREATER_POLAND.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value >= 0.05
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		random_state = {
			limit = {
				state_region = s:STATE_GREATER_POLAND
			}
			save_temporary_scope_as = german_expulsion_state
			add_modifier = {
				name = ongoing_exile
				days = 42
			}
		}
		random_state = {
			limit = {
				owner = c:DDR
			}
			save_temporary_scope_as = german_migration_target_state
		}
		c:POL = {
			save_temporary_scope_as = migration_country
		}
		c:DDR = {
			save_temporary_scope_as = exile_country
		}
		cu:north_german = {
			save_temporary_scope_as = migration_culture
		}

		custom_tooltip = {
			text = exile_germans_tt
			scope:german_expulsion_state = {
				every_scope_pop = {
					limit = {
						culture = scope:migration_culture
					}
					change_pop_culture = {
						target = cu:immigrant
						value = 0.5
					}
				}
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					move_pop = scope:german_migration_target_state
				}
			}
			scope:exile_country = {
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					change_pop_culture = { target = scope:migration_culture value = 1 }
				}
			}
		}
		#every_country = {
		#	limit = {
		#		is_ai = no
		#		this = c:POL
		#	}
		#	post_notification = eligible_for_exile
		#}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_silesia_button = {
	name = german_expulsion_silesia_button
	desc = german_expulsion_silesia_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_SILESIA
			culture_percent_state = {
				target = cu:north_german
				value > 0.05
			}
		}
	}

	possible = {
		s:STATE_SILESIA.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value >= 0.05
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		random_state = {
			limit = {
				state_region = s:STATE_SILESIA
			}
			save_temporary_scope_as = german_expulsion_state
			add_modifier = {
				name = ongoing_exile
				days = 42
			}
		}
		random_state = {
			limit = {
				owner = c:DDR
			}
			save_temporary_scope_as = german_migration_target_state
		}
		c:POL = {
			save_temporary_scope_as = migration_country
		}
		c:DDR = {
			save_temporary_scope_as = exile_country
		}
		cu:north_german = {
			save_temporary_scope_as = migration_culture
		}

		custom_tooltip = {
			text = exile_germans_tt
			scope:german_expulsion_state = {
				every_scope_pop = {
					limit = {
						culture = scope:migration_culture
					}
					change_pop_culture = {
						target = cu:immigrant
						value = 0.5
					}
				}
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					move_pop = scope:german_migration_target_state
				}
			}
			scope:exile_country = {
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					change_pop_culture = { target = scope:migration_culture value = 1 }
				}
			}
		}
		#every_country = {
		#	limit = {
		#		is_ai = no
		#		this = c:POL
		#	}
		#	post_notification = eligible_for_exile
		#}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_pomemasuria_button = {
	name = german_expulsion_pomemasuria_button
	desc = german_expulsion_pomemasuria_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_POMEMASURIA
			culture_percent_state = {
				target = cu:north_german
				value > 0.05
			}
		}
	}

	possible = {
		s:STATE_POMEMASURIA.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value >= 0.05
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		random_state = {
			limit = {
				state_region = s:STATE_POMEMASURIA
			}
			save_temporary_scope_as = german_expulsion_state
			add_modifier = {
				name = ongoing_exile
				days = 42
			}
		}
		random_state = {
			limit = {
				owner = c:DDR
			}
			save_temporary_scope_as = german_migration_target_state
		}
		c:POL = {
			save_temporary_scope_as = migration_country
		}
		c:DDR = {
			save_temporary_scope_as = exile_country
		}
		cu:north_german = {
			save_temporary_scope_as = migration_culture
		}

		custom_tooltip = {
			text = exile_germans_tt
			scope:german_expulsion_state = {
				every_scope_pop = {
					limit = {
						culture = scope:migration_culture
					}
					change_pop_culture = {
						target = cu:immigrant
						value = 0.5
					}
				}
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					move_pop = scope:german_migration_target_state
				}
			}
			scope:exile_country = {
				every_scope_pop = {
					limit = {
						culture = cu:immigrant
					}
					change_pop_culture = { target = scope:migration_culture value = 1 }
				}
			}
		}
		#every_country = {
		#	limit = {
		#		is_ai = no
		#		this = c:POL
		#	}
		#	post_notification = eligible_for_exile
		#}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_pomerania_remove_homeland_button = {
	name = german_expulsion_pomerania_remove_homeland_button
	desc = german_expulsion_pomerania_remove_homeland_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_WEST_POMERANIA
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
			any_scope_culture = {
				this = cu:north_german 
				has_homeland = PREV
			}
		}
	}

	possible = {
		s:STATE_WEST_POMERANIA.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
		}
		custom_tooltip = {
			text = has_german_homeland_tt
			s:STATE_WEST_POMERANIA.region_state:POL = {
				any_scope_culture = {
					this = cu:north_german 
					has_homeland = PREV
				}
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		custom_tooltip = {
			text = remove_homeland_tt_pomerania
			random_state = {
				limit = {
					state_region = s:STATE_WEST_POMERANIA
				}
				state_region = {
					remove_homeland = cu:north_german
				}
			}
		}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_gr_poland_remove_homeland_button = {
	name = german_expulsion_gr_poland_remove_homeland_button
	desc = german_expulsion_gr_poland_remove_homeland_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_GREATER_POLAND
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
			any_scope_culture = {
				this = cu:north_german 
				has_homeland = PREV
			}
		}
	}

	possible = {
		s:STATE_GREATER_POLAND.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
		}
		custom_tooltip = {
			text = has_german_homeland_tt
			s:STATE_GREATER_POLAND.region_state:POL = {
				any_scope_culture = {
					this = cu:north_german 
					has_homeland = PREV
				}
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		custom_tooltip = {
			text = remove_homeland_tt_gr_poland
			random_state = {
				limit = {
					state_region = s:STATE_GREATER_POLAND
				}
				state_region = {
					remove_homeland = cu:north_german
				}
			}
		}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_silesia_remove_homeland_button = {
	name = german_expulsion_silesia_remove_homeland_button
	desc = german_expulsion_silesia_remove_homeland_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_SILESIA
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
			any_scope_culture = {
				this = cu:north_german 
				has_homeland = PREV
			}
		}
	}

	possible = {
		s:STATE_SILESIA.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
		}
		custom_tooltip = {
			text = has_german_homeland_tt
			s:STATE_SILESIA.region_state:POL = {
				any_scope_culture = {
					this = cu:north_german 
					has_homeland = PREV
				}
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		custom_tooltip = {
			text = remove_homeland_tt_silesia
			random_state = {
				limit = {
					state_region = s:STATE_SILESIA
				}
				state_region = {
					remove_homeland = cu:north_german
				}
			}
		}
	}

	ai_chance = {
		base = 1
	}
}

german_expulsion_pomemasuria_remove_homeland_button = {
	name = german_expulsion_pomemasuria_remove_homeland_button
	desc = german_expulsion_pomemasuria_remove_homeland_button_desc

	visible = {
		any_scope_state = {
			state_region = s:STATE_POMEMASURIA
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
			any_scope_culture = {
				this = cu:north_german 
				has_homeland = PREV
			}
		}
	}

	possible = {
		s:STATE_POMEMASURIA.region_state:POL = {
			culture_percent_state = {
				target = cu:north_german
				value < 0.05
			}
		}
		custom_tooltip = {
			text = has_german_homeland_tt
			s:STATE_POMEMASURIA.region_state:POL = {
				any_scope_culture = {
					this = cu:north_german 
					has_homeland = PREV
				}
			}
		}
		NOT = {
			any_scope_state = {
				has_modifier = ongoing_exile
			}
		}
		this = c:POL
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		custom_tooltip = {
			text = remove_homeland_tt_pomemasuria
			random_state = {
				limit = {
					state_region = s:STATE_POMEMASURIA
				}
				state_region = {
					remove_homeland = cu:north_german
				}
			}
		}
	}

	ai_chance = {
		base = 1
	}
}